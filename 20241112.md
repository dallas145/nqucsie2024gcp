# 第十週

## Unmanaged load balancer but block the direct access to VM
建立vpc：
- Name: `myvpc1`
    - Subnet creation mode: `Custom`
    - New subnet:
        - Name: `asia-east1`
        - Region: `asia-east1`
        - IPv4 range: `10.10.0.0/24`
    - Firewall rules:
        - `myvpc1-allow-icmp`
        - `myvpc1-allow-ssh`

建立兩台虛擬機：
- Name: `myvm1` and `myvm2`
    - Region: `asia-east1`
    - Machine configuration:
        - Series: `N1`
    - Boot disk:
        - Operating system: `Ubuntu`
        - Version: `Ubuntu 20.04 LTS`
    - Firewall: `Allow HTTP traffic`
    - Advanced options:
        - Networking:
            - Network interfaces:
            - Network: `myvpc1`
        - Management:
            - Automation:
            - Startup script:
            ```bash
            #!/bin/bash
            apt update
            apt -y install apache2
            cat<<EOF > /var/www/html/index.html
            <html><body><p>Linux startup script added directly. $(hostname -I)</p></body></html>
            ```

建立Instance group：
- New unmanaged instance group:
    - Name: `mygroup1`
    - Region: `asia-east1`
    - Network: `myvpc1`
    - VM instances: `myvm1 and myvm2`

建立Load balancer：
- Type of load balancer: `Application Load Balancer (HTTP/HTTPS)`
- Public facing of internal: `Public facing (external)`
- Global of single region deployment: `Best for regional workloads`
- Configure:
    - Load Balancer name: `mylb`
    - Region: `asia-east1 (Taiwan)`
    - Network: `myvpc1`
    - Proxy-only subnet:
        - 如果不能自動Reserve，開啟Cloud Shell並執行以下指令（參考：[Google Cloud 說明文件](https://cloud.google.com/load-balancing/docs/proxy-only-subnets#gcloud)）：
            ```
            gcloud compute networks subnets create myvpc1-subnet \
                --purpose=REGIONAL_MANAGED_PROXY \
                --role=ACTIVE \
                --region=asia-east1 \
                --network=myvpc1 \
                --range=10.0.0.0/24
            ```
    - Frontend configuration:
        - Name: `myfrontend`
    - Backend configuration:
        - Create backend service:
            - Name: `mybackend`
            - Backend type: `Instance group`
        - New Backend:
            - Instance group: `mygroup1`
            - Port numbers: `80`
        - Create a Health Check
            - Name: `myhealthcheck`

## Managed load balancer

- [ ] watch course video to finish.
